#!/usr/bin/env node

'use strict';

var readline = require('readline');
var Parser = require('../lib/parser');
var Compiler = require('../lib/compiler');

console.log('Welcome to meowscriptðŸ˜¼');

var rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout,
});

rl.setPrompt('=> ');
rl.prompt();

rl.on('line', function(line) {
  if (line.trim() === '') {
    rl.prompt();
    return;
  }

  var parser = new Parser(line);
  try {
    var expr = parser.parse();
    console.log(expr.toString());
  } catch (err) {
    console.warn(err.stack);
  }

  var compiler = new Compiler();
  console.log(compiler.compile(expr));

  rl.prompt();
}).on('close', function() {
  console.log('Bye!');
  process.exit(0);
});
